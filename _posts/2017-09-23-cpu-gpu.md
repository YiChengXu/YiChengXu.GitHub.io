---
layout: post
title: 优化思路GPU和CPU
date: 2017-09-23
categories: blog
tags: [图像优化]
description: 在这里我们简单来讲讲iOS图形优化的思路

---

* 1、概述
* 1、GPU
* 2、CPU

## 概述
从计算机的角度来说，绘图都是只有两种方式，一种是CPU绘制一种是GPU绘制。总体来说，GPU绘制更为良好，毕竟从GPU的硬件设计来说，天生就对图像进行了大量的优化。但是如果GPU的负载已经很高了呢？那么性能就会以几何倍的下降了。这篇文章我们就来讲讲GPU和CPU会降低性能的一些问题吧。

## GPU
### 1.几何结构的变换
当然这个问题，严格意义上应该归结于CPU的问题，现在的iOS设备可以处理百万级别的三角形(CPU传输给GPU三维形状数据到了GPU中GPU会根据三个顶点自动连接成一个三角面)因此单纯的几何结构应该不构成应用的瓶颈。但是真正的问题在于，如此多的三角形在送至GPU之前，需要CPU对图层进行计算大量的图层最终就会变成一个超重量级的对象了对CPU是一种负担。

### 2.重绘
这个问题往往是由于开发者在应用中大量使用重叠的半透明的图层导致的。由于GPU的填充比率是有限的，所以我们尽量避免重绘。虽然重实际角度来说这个问题会非常的不明显。特别是opaque属性default is YES。

### 3.离屏绘制
这发生在当不能直接在屏幕上绘制，并且必须绘制到离屏图片的上下文中的时候。离屏绘制发生在基于CPU或者是GPU的渲染，或者是为离屏图片分配额外内存，以及切换绘制上下文，这些都会降低GPU性能。典型的会触发离屏渲染的地方是圆角，mask，阴影或者光栅化。但是离屏渲染不一定只会带来坏处，有时候会带来一些好处，这个我们后面再说。

### 4.超大的图片
iPhone最大支持的渲染纹理为2048\*2048或者是4096\*4096(这个根据设备的不同而有所不同)，当图片的大小超过这个时，CPU必须对图片进行处理，GPU才能使用，这同样会消耗性能。

## CPU
(未完待续，有空在补上吧)

